using System;
using HooksLib;

namespace ForegroundAppKiller.Models;

public static class KeyConverter
{
    
    private static readonly Key[] HookKeys =
    {
        Key.None,
        Key.Cancel,
        Key.Back,
        Key.Tab,
        Key.LineFeed,
        Key.Clear,
        Key.Return,
        Key.Pause,
        Key.Capital,
        Key.KanaMode,
        Key.JunjaMode,
        Key.FinalMode,
        Key.HanjaMode,
        Key.Escape,
        Key.IMEConvert,
        Key.IMENonconvert,
        Key.IMEAccept,
        Key.IMEModeChange,
        Key.Space,
        Key.Prior,
        Key.Next,
        Key.End,
        Key.Home,
        Key.Left,
        Key.Up,
        Key.Right,
        Key.Down,
        Key.Select,
        Key.Print,
        Key.Execute,
        Key.Snapshot,
        Key.Insert,
        Key.Delete,
        Key.Help,
        Key.D0,
        Key.D1,
        Key.D2,
        Key.D3,
        Key.D4,
        Key.D5,
        Key.D6,
        Key.D7,
        Key.D8,
        Key.D9,
        Key.A,
        Key.B,
        Key.C,
        Key.D,
        Key.E,
        Key.F,
        Key.G,
        Key.H,
        Key.I,
        Key.J,
        Key.K,
        Key.L,
        Key.M,
        Key.N,
        Key.O,
        Key.P,
        Key.Q,
        Key.R,
        Key.S,
        Key.T,
        Key.U,
        Key.V,
        Key.W,
        Key.X,
        Key.Y,
        Key.Z,
        Key.LWin,
        Key.RWin,
        Key.Apps,
        Key.Sleep,
        Key.NumPad0,
        Key.NumPad1,
        Key.NumPad2,
        Key.NumPad3,
        Key.NumPad4,
        Key.NumPad5,
        Key.NumPad6,
        Key.NumPad7,
        Key.NumPad8,
        Key.NumPad9,
        Key.Multiply,
        Key.Add,
        Key.Separator,
        Key.Subtract,
        Key.Decimal,
        Key.Divide,
        Key.F1,
        Key.F2,
        Key.F3,
        Key.F4,
        Key.F5,
        Key.F6,
        Key.F7,
        Key.F8,
        Key.F9,
        Key.F10,
        Key.F11,
        Key.F12,
        Key.F13,
        Key.F14,
        Key.F15,
        Key.F16,
        Key.F17,
        Key.F18,
        Key.F19,
        Key.F20,
        Key.F21,
        Key.F22,
        Key.F23,
        Key.F24,
        Key.NumLock,
        Key.Scroll,
        Key.LShiftKey,
        Key.RShiftKey,
        Key.LControlKey,
        Key.RControlKey,
        Key.LAlt,
        Key.RAlt,
        Key.BrowserBack,
        Key.BrowserForward,
        Key.BrowserRefresh,
        Key.BrowserStop,
        Key.BrowserSearch,
        Key.BrowserFavorites,
        Key.BrowserHome,
        Key.VolumeMute,
        Key.VolumeDown,
        Key.VolumeUp,
        Key.MediaNextTrack,
        Key.MediaPreviousTrack,
        Key.MediaStop,
        Key.MediaPlayPause,
        Key.LaunchMail,
        Key.SelectMedia,
        Key.LaunchApplication1,
        Key.LaunchApplication2,
        Key.OemSemicolon,
        Key.Oemplus,
        Key.Oemcomma,
        Key.OemMinus,
        Key.OemPeriod,
        Key.OemQuestion,
        Key.Oemtilde,
        Key.OemOpenBrackets,
        Key.OemPipe,
        Key.OemCloseBrackets,
        Key.OemQuotes,
        Key.Oem8,
        Key.OemBackslash,
        Key.ProcessKey,
        Key.Attn,
        Key.Crsel,
        Key.Exsel,
        Key.EraseEof,
        Key.Play,
        Key.Zoom,
        Key.NoName,
        Key.Pa1,
        Key.OemClear
    };

    private static readonly System.Windows.Input.Key[] WpfKeys =
    {
        System.Windows.Input.Key.None,
        System.Windows.Input.Key.Cancel,
        System.Windows.Input.Key.Back,
        System.Windows.Input.Key.Tab,
        System.Windows.Input.Key.LineFeed,
        System.Windows.Input.Key.Clear,
        System.Windows.Input.Key.Return,
        System.Windows.Input.Key.Pause,
        System.Windows.Input.Key.Capital,
        System.Windows.Input.Key.KanaMode,
        System.Windows.Input.Key.JunjaMode,
        System.Windows.Input.Key.FinalMode,
        System.Windows.Input.Key.HanjaMode,
        System.Windows.Input.Key.Escape,
        System.Windows.Input.Key.ImeConvert,
        System.Windows.Input.Key.ImeNonConvert,
        System.Windows.Input.Key.ImeAccept,
        System.Windows.Input.Key.ImeModeChange,
        System.Windows.Input.Key.Space,
        System.Windows.Input.Key.PageUp,
        System.Windows.Input.Key.PageDown,
        System.Windows.Input.Key.End,
        System.Windows.Input.Key.Home,
        System.Windows.Input.Key.Left,
        System.Windows.Input.Key.Up,
        System.Windows.Input.Key.Right,
        System.Windows.Input.Key.Down,
        System.Windows.Input.Key.Select,
        System.Windows.Input.Key.Print,
        System.Windows.Input.Key.Execute,
        System.Windows.Input.Key.PrintScreen,
        System.Windows.Input.Key.Insert,
        System.Windows.Input.Key.Delete,
        System.Windows.Input.Key.Help,
        System.Windows.Input.Key.D0,
        System.Windows.Input.Key.D1,
        System.Windows.Input.Key.D2,
        System.Windows.Input.Key.D3,
        System.Windows.Input.Key.D4,
        System.Windows.Input.Key.D5,
        System.Windows.Input.Key.D6,
        System.Windows.Input.Key.D7,
        System.Windows.Input.Key.D8,
        System.Windows.Input.Key.D9,
        System.Windows.Input.Key.A,
        System.Windows.Input.Key.B,
        System.Windows.Input.Key.C,
        System.Windows.Input.Key.D,
        System.Windows.Input.Key.E,
        System.Windows.Input.Key.F,
        System.Windows.Input.Key.G,
        System.Windows.Input.Key.H,
        System.Windows.Input.Key.I,
        System.Windows.Input.Key.J,
        System.Windows.Input.Key.K,
        System.Windows.Input.Key.L,
        System.Windows.Input.Key.M,
        System.Windows.Input.Key.N,
        System.Windows.Input.Key.O,
        System.Windows.Input.Key.P,
        System.Windows.Input.Key.Q,
        System.Windows.Input.Key.R,
        System.Windows.Input.Key.S,
        System.Windows.Input.Key.T,
        System.Windows.Input.Key.U,
        System.Windows.Input.Key.V,
        System.Windows.Input.Key.W,
        System.Windows.Input.Key.X,
        System.Windows.Input.Key.Y,
        System.Windows.Input.Key.Z,
        System.Windows.Input.Key.LWin,
        System.Windows.Input.Key.RWin,
        System.Windows.Input.Key.Apps,
        System.Windows.Input.Key.Sleep,
        System.Windows.Input.Key.NumPad0,
        System.Windows.Input.Key.NumPad1,
        System.Windows.Input.Key.NumPad2,
        System.Windows.Input.Key.NumPad3,
        System.Windows.Input.Key.NumPad4,
        System.Windows.Input.Key.NumPad5,
        System.Windows.Input.Key.NumPad6,
        System.Windows.Input.Key.NumPad7,
        System.Windows.Input.Key.NumPad8,
        System.Windows.Input.Key.NumPad9,
        System.Windows.Input.Key.Multiply,
        System.Windows.Input.Key.Add,
        System.Windows.Input.Key.Separator,
        System.Windows.Input.Key.Subtract,
        System.Windows.Input.Key.Decimal,
        System.Windows.Input.Key.Divide,
        System.Windows.Input.Key.F1,
        System.Windows.Input.Key.F2,
        System.Windows.Input.Key.F3,
        System.Windows.Input.Key.F4,
        System.Windows.Input.Key.F5,
        System.Windows.Input.Key.F6,
        System.Windows.Input.Key.F7,
        System.Windows.Input.Key.F8,
        System.Windows.Input.Key.F9,
        System.Windows.Input.Key.F10,
        System.Windows.Input.Key.F11,
        System.Windows.Input.Key.F12,
        System.Windows.Input.Key.F13,
        System.Windows.Input.Key.F14,
        System.Windows.Input.Key.F15,
        System.Windows.Input.Key.F16,
        System.Windows.Input.Key.F17,
        System.Windows.Input.Key.F18,
        System.Windows.Input.Key.F19,
        System.Windows.Input.Key.F20,
        System.Windows.Input.Key.F21,
        System.Windows.Input.Key.F22,
        System.Windows.Input.Key.F23,
        System.Windows.Input.Key.F24,
        System.Windows.Input.Key.NumLock,
        System.Windows.Input.Key.Scroll,
        System.Windows.Input.Key.LeftShift,
        System.Windows.Input.Key.RightShift,
        System.Windows.Input.Key.LeftCtrl,
        System.Windows.Input.Key.RightCtrl,
        System.Windows.Input.Key.LeftAlt,
        System.Windows.Input.Key.RightAlt,
        System.Windows.Input.Key.BrowserBack,
        System.Windows.Input.Key.BrowserForward,
        System.Windows.Input.Key.BrowserRefresh,
        System.Windows.Input.Key.BrowserStop,
        System.Windows.Input.Key.BrowserSearch,
        System.Windows.Input.Key.BrowserFavorites,
        System.Windows.Input.Key.BrowserHome,
        System.Windows.Input.Key.VolumeMute,
        System.Windows.Input.Key.VolumeDown,
        System.Windows.Input.Key.VolumeUp,
        System.Windows.Input.Key.MediaNextTrack,
        System.Windows.Input.Key.MediaPreviousTrack,
        System.Windows.Input.Key.MediaStop,
        System.Windows.Input.Key.MediaPlayPause,
        System.Windows.Input.Key.LaunchMail,
        System.Windows.Input.Key.SelectMedia,
        System.Windows.Input.Key.LaunchApplication1,
        System.Windows.Input.Key.LaunchApplication2,
        System.Windows.Input.Key.Oem1,
        System.Windows.Input.Key.OemPlus,
        System.Windows.Input.Key.OemComma,
        System.Windows.Input.Key.OemMinus,
        System.Windows.Input.Key.OemPeriod,
        System.Windows.Input.Key.Oem2,
        System.Windows.Input.Key.Oem3,
        System.Windows.Input.Key.Oem4,
        System.Windows.Input.Key.Oem5,
        System.Windows.Input.Key.Oem6,
        System.Windows.Input.Key.Oem7,
        System.Windows.Input.Key.Oem8,
        System.Windows.Input.Key.Oem102,
        System.Windows.Input.Key.ImeProcessed,
        System.Windows.Input.Key.Attn,
        System.Windows.Input.Key.CrSel,
        System.Windows.Input.Key.ExSel,
        System.Windows.Input.Key.EraseEof,
        System.Windows.Input.Key.Play,
        System.Windows.Input.Key.Zoom,
        System.Windows.Input.Key.NoName,
        System.Windows.Input.Key.Pa1,
        System.Windows.Input.Key.OemClear
    };

    public static System.Windows.Input.Key ToWpfKey(this Key key)
    {
        var index = Array.IndexOf(HookKeys, key);
        if (index < 0)
            throw new ArgumentOutOfRangeException(nameof(key));

        return WpfKeys[index];
    }

    public static Key ToHookKey(this System.Windows.Input.Key key)
    {
        var index = Array.IndexOf(WpfKeys, key);
        if (index < 0)
            throw new ArgumentOutOfRangeException(nameof(key));

        return HookKeys[index];
    }
}